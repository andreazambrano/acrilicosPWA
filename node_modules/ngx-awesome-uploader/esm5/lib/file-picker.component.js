/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { FilePickerService } from './file-picker.service';
import { Component, ElementRef, EventEmitter, Input, Output, TemplateRef } from '@angular/core';
import { getFileType } from './file-upload.utils';
import { FileValidationTypes } from './validation-error.model';
import { FilePickerAdapter } from './file-picker.adapter';
import { combineLatest, of, Subject } from 'rxjs';
import { map, takeUntil, tap } from 'rxjs/operators';
import { DefaultCaptions } from './default-captions';
var FilePickerComponent = /** @class */ (function () {
    function FilePickerComponent(fileService, elementRef) {
        this.fileService = fileService;
        this.elementRef = elementRef;
        /**
         * Emitted when file is uploaded via api successfully. Emitted for every file
         */
        this.uploadSuccess = new EventEmitter();
        /**
         * Emitted when file is removed via api successfully. Emitted for every file
         */
        this.removeSuccess = new EventEmitter();
        /**
         * Emitted on file validation fail
         */
        this.validationError = new EventEmitter();
        /**
         * Emitted when file is added and passed validations. Not uploaded yet
         */
        this.fileAdded = new EventEmitter();
        /**
         * Whether to enable cropper. Default: disabled
         */
        this.enableCropper = false;
        /**
         * Whether to show default drag and drop zone. Default:true
         */
        this.showeDragDropZone = true;
        /**
         * Whether to show default files preview container. Default: true
         */
        this.showPreviewContainer = true;
        /**
         * Single or multiple. Default: multi
         */
        this.uploadType = 'multi';
        this.files = [];
        /**
         * Files array for cropper. Will be shown equentially if crop enabled
         */
        this.filesForCropper = [];
        this.cropClosed$ = new Subject();
        this._onDestroy$ = new Subject();
    }
    /**
     * @return {?}
     */
    FilePickerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.setCropperOptions();
        this.listenToCropClose();
        this.setCaptions();
    };
    /**
     * @return {?}
     */
    FilePickerComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this._onDestroy$.next();
    };
    /**
     * @return {?}
     */
    FilePickerComponent.prototype.setCaptions = /**
     * @return {?}
     */
    function () {
        this._captions = this.captions || DefaultCaptions;
    };
    /** Listen when Cropper is closed and open new cropper if next image exists */
    /**
     * Listen when Cropper is closed and open new cropper if next image exists
     * @return {?}
     */
    FilePickerComponent.prototype.listenToCropClose = /**
     * Listen when Cropper is closed and open new cropper if next image exists
     * @return {?}
     */
    function () {
        var _this = this;
        this.cropClosed$
            .pipe(takeUntil(this._onDestroy$))
            .subscribe((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            /** @type {?} */
            var croppedIndex = _this.filesForCropper.findIndex((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item.name === res.fileName; }));
            /** @type {?} */
            var nextFile = croppedIndex !== -1 ? _this.filesForCropper[croppedIndex + 1] : undefined;
            // console.log(nextFile)
            //  console.log('cropped', res);
            _this.filesForCropper = tslib_1.__spread(_this.filesForCropper).filter((/**
             * @param {?} item
             * @return {?}
             */
            function (item) { return item.name !== res.fileName; }));
            // console.log(this.filesForCropper);
            if (nextFile) {
                _this.openCropper(nextFile);
            }
        }));
    };
    /** Sets custom cropper options if avaiable */
    /**
     * Sets custom cropper options if avaiable
     * @return {?}
     */
    FilePickerComponent.prototype.setCropperOptions = /**
     * Sets custom cropper options if avaiable
     * @return {?}
     */
    function () {
        if (!this.cropperOptions) {
            this.setDefaultCropperOptions();
        }
    };
    /** Sets manual cropper options if no custom options are avaiable */
    /**
     * Sets manual cropper options if no custom options are avaiable
     * @return {?}
     */
    FilePickerComponent.prototype.setDefaultCropperOptions = /**
     * Sets manual cropper options if no custom options are avaiable
     * @return {?}
     */
    function () {
        this.cropperOptions = {
            dragMode: 'crop',
            aspectRatio: 1,
            autoCrop: true,
            movable: true,
            zoomable: true,
            scalable: true,
            autoCropArea: 0.8
        };
    };
    /** On input file selected */
    /**
     * On input file selected
     * @param {?} fileInput
     * @return {?}
     */
    FilePickerComponent.prototype.onChange = /**
     * On input file selected
     * @param {?} fileInput
     * @return {?}
     */
    function (fileInput) {
        /** @type {?} */
        var files = Array.from(fileInput.files);
        this.handleFiles(files).subscribe();
    };
    /** Handles input and drag/drop files */
    /**
     * Handles input and drag/drop files
     * @param {?} files
     * @return {?}
     */
    FilePickerComponent.prototype.handleFiles = /**
     * Handles input and drag/drop files
     * @param {?} files
     * @return {?}
     */
    function (files) {
        var _this = this;
        if (!this.isValidMaxFileCount(files)) {
            return of(null);
        }
        /** @type {?} */
        var isValidUploadSync = files.every((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return _this.validateFileSync(item); }));
        /** @type {?} */
        var asyncFunctions = files.map((/**
         * @param {?} item
         * @return {?}
         */
        function (item) { return _this.validateFileAsync(item); }));
        return combineLatest.apply(void 0, tslib_1.__spread(asyncFunctions)).pipe(map((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            /** @type {?} */
            var isValidUploadAsync = res.every((/**
             * @param {?} result
             * @return {?}
             */
            function (result) { return result === true; }));
            if (!isValidUploadSync || !isValidUploadAsync) {
                return;
            }
            files.forEach((/**
             * @param {?} file
             * @param {?} index
             * @return {?}
             */
            function (file, index) {
                _this.handleInputFile(file, index);
            }));
        })));
    };
    /** Validates synchronous validations */
    /**
     * Validates synchronous validations
     * @param {?} file
     * @return {?}
     */
    FilePickerComponent.prototype.validateFileSync = /**
     * Validates synchronous validations
     * @param {?} file
     * @return {?}
     */
    function (file) {
        if (!file) {
            return;
        }
        if (!this.isValidUploadType(file)) {
            return;
        }
        if (!this.isValidExtension(file, file.name)) {
            return;
        }
        return true;
    };
    /** Validates asynchronous validations */
    /**
     * Validates asynchronous validations
     * @param {?} file
     * @return {?}
     */
    FilePickerComponent.prototype.validateFileAsync = /**
     * Validates asynchronous validations
     * @param {?} file
     * @return {?}
     */
    function (file) {
        var _this = this;
        if (!this.customValidator) {
            return of(true);
        }
        return this.customValidator(file).pipe(tap((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            if (!res) {
                _this.validationError.next({ file: file, error: FileValidationTypes.customValidator });
            }
        })));
    };
    /** Handles input and drag&drop files */
    /**
     * Handles input and drag&drop files
     * @param {?} file
     * @param {?} index
     * @return {?}
     */
    FilePickerComponent.prototype.handleInputFile = /**
     * Handles input and drag&drop files
     * @param {?} file
     * @param {?} index
     * @return {?}
     */
    function (file, index) {
        /** @type {?} */
        var type = getFileType(file.type);
        if (type === 'image' && this.enableCropper) {
            this.filesForCropper.push(file);
            if (!(this.currentCropperFile)) {
                this.openCropper(file);
            }
        }
        else {
            /** Size is not initially checked on handleInputFiles because of cropper size change */
            if (this.isValidSize(file, file.size)) {
                this.pushFile(file);
            }
        }
    };
    /** Validates if upload type is single so another file cannot be added */
    /**
     * Validates if upload type is single so another file cannot be added
     * @param {?} file
     * @return {?}
     */
    FilePickerComponent.prototype.isValidUploadType = /**
     * Validates if upload type is single so another file cannot be added
     * @param {?} file
     * @return {?}
     */
    function (file) {
        if (this.uploadType === 'single' && this.files.length > 0) {
            this.validationError.next({ file: file, error: FileValidationTypes.uploadType });
            return false;
        }
        else {
            return true;
        }
    };
    /** Validates max file count */
    /**
     * Validates max file count
     * @param {?} files
     * @return {?}
     */
    FilePickerComponent.prototype.isValidMaxFileCount = /**
     * Validates max file count
     * @param {?} files
     * @return {?}
     */
    function (files) {
        if (!this.fileMaxCount || this.fileMaxCount >= this.files.length + files.length) {
            return true;
        }
        else {
            this.validationError.next({ file: null, error: FileValidationTypes.fileMaxCount });
            return false;
        }
    };
    /** On file dropped */
    /**
     * On file dropped
     * @param {?} event
     * @return {?}
     */
    FilePickerComponent.prototype.dropped = /**
     * On file dropped
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        var e_1, _a;
        /** @type {?} */
        var files = event.files;
        /** @type {?} */
        var filesForUpload = [];
        try {
            for (var _b = tslib_1.__values(event.files), _c = _b.next(); !_c.done; _c = _b.next()) {
                var droppedFile = _c.value;
                // Is it a file?
                if (droppedFile.fileEntry.isFile) {
                    /** @type {?} */
                    var fileEntry = (/** @type {?} */ (droppedFile.fileEntry));
                    fileEntry.file((/**
                     * @param {?} file
                     * @return {?}
                     */
                    function (file) {
                        filesForUpload.push(file);
                    }));
                }
                else {
                    // It was a directory (empty directories are added, otherwise only files)
                    /** @type {?} */
                    var fileEntry = (/** @type {?} */ (droppedFile.fileEntry));
                    // console.log(droppedFile.relativePath, fileEntry);
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        setTimeout((/**
         * @return {?}
         */
        function () { return _this.handleFiles(filesForUpload).subscribe(); }));
    };
    /** Add file to file list after succesfull validation */
    /**
     * Add file to file list after succesfull validation
     * @param {?} file
     * @param {?=} fileName
     * @return {?}
     */
    FilePickerComponent.prototype.pushFile = /**
     * Add file to file list after succesfull validation
     * @param {?} file
     * @param {?=} fileName
     * @return {?}
     */
    function (file, fileName) {
        if (fileName === void 0) { fileName = file.name; }
        this.files.push({ file: file, fileName: fileName });
        this.fileAdded.next({ file: file, fileName: fileName });
    };
    /** Opens cropper for image crop */
    /**
     * Opens cropper for image crop
     * @param {?} file
     * @return {?}
     */
    FilePickerComponent.prototype.openCropper = /**
     * Opens cropper for image crop
     * @param {?} file
     * @return {?}
     */
    function (file) {
        if (((/** @type {?} */ (window))).UPLOADER_TEST_MODE || typeof Cropper !== 'undefined') {
            this.safeCropImgUrl = this.fileService.createSafeUrl(file);
            this.currentCropperFile = file;
        }
        else {
            console.warn('please import cropperjs script and styles to use cropper feature or disable it by setting [enableCropper]="false"');
            return;
        }
    };
    /**
     * @param {?} file
     * @return {?}
     */
    FilePickerComponent.prototype.getSafeUrl = /**
     * @param {?} file
     * @return {?}
     */
    function (file) {
        return this.fileService.createSafeUrl(file);
    };
    /** On img load event */
    /**
     * On img load event
     * @param {?} e
     * @return {?}
     */
    FilePickerComponent.prototype.cropperImgLoaded = /**
     * On img load event
     * @param {?} e
     * @return {?}
     */
    function (e) {
        /** @type {?} */
        var image = document.getElementById('cropper-img');
        this.cropper = new Cropper(image, this.cropperOptions);
    };
    /** Close or cancel cropper */
    /**
     * Close or cancel cropper
     * @param {?} filePreview
     * @return {?}
     */
    FilePickerComponent.prototype.closeCropper = /**
     * Close or cancel cropper
     * @param {?} filePreview
     * @return {?}
     */
    function (filePreview) {
        var _this = this;
        this.currentCropperFile = undefined;
        this.cropper = undefined;
        setTimeout((/**
         * @return {?}
         */
        function () { return _this.cropClosed$.next(filePreview); }), 200);
    };
    /** Removes files from files list */
    /**
     * Removes files from files list
     * @param {?} file
     * @return {?}
     */
    FilePickerComponent.prototype.removeFileFromList = /**
     * Removes files from files list
     * @param {?} file
     * @return {?}
     */
    function (file) {
        this.files = this.files.filter((/**
         * @param {?} f
         * @return {?}
         */
        function (f) { return f !== file; }));
    };
    /** Emits event when file upload api returns success  */
    /**
     * Emits event when file upload api returns success
     * @param {?} fileItem
     * @return {?}
     */
    FilePickerComponent.prototype.onUploadSuccess = /**
     * Emits event when file upload api returns success
     * @param {?} fileItem
     * @return {?}
     */
    function (fileItem) {
        this.uploadSuccess.next(fileItem);
    };
    /** Validates file extension */
    /**
     * Validates file extension
     * @param {?} file
     * @param {?} fileName
     * @return {?}
     */
    FilePickerComponent.prototype.isValidExtension = /**
     * Validates file extension
     * @param {?} file
     * @param {?} fileName
     * @return {?}
     */
    function (file, fileName) {
        if (!this.fileExtensions) {
            return true;
        }
        /** @type {?} */
        var extension = fileName.split('.').pop();
        /** @type {?} */
        var fileExtensions = this.fileExtensions.map((/**
         * @param {?} ext
         * @return {?}
         */
        function (ext) { return ext.toLowerCase(); }));
        if (fileExtensions.indexOf(extension.toLowerCase()) === -1) {
            this.validationError.next({ file: file, error: FileValidationTypes.extensions });
            return false;
        }
        return true;
    };
    /** Validates selected file size and total file size */
    /**
     * Validates selected file size and total file size
     * @param {?} file
     * @param {?} size
     * @return {?}
     */
    FilePickerComponent.prototype.isValidSize = /**
     * Validates selected file size and total file size
     * @param {?} file
     * @param {?} size
     * @return {?}
     */
    function (file, size) {
        /**
         * Validating selected file size
         * @type {?}
         */
        var res = this.bitsToMb(size.toString());
        /** @type {?} */
        var isValidFileSize;
        /** @type {?} */
        var isValidTotalFileSize;
        if (!this.fileMaxSize || (this.fileMaxSize && res < this.fileMaxSize)) {
            isValidFileSize = true;
        }
        else {
            this.validationError.next({ file: file, error: FileValidationTypes.fileMaxSize });
        }
        /**
         * Validating Total Files Size
         * @type {?}
         */
        var totalBits = this.files.map((/**
         * @param {?} f
         * @return {?}
         */
        function (f) { return f.file.size; })).reduce((/**
         * @param {?} acc
         * @param {?} curr
         * @return {?}
         */
        function (acc, curr) { return acc + curr; }), 0);
        if (!this.totalMaxSize || (this.totalMaxSize && this.bitsToMb(totalBits + file.size) < this.totalMaxSize)) {
            isValidTotalFileSize = true;
        }
        else {
            this.validationError.next({ file: file, error: FileValidationTypes.totalMaxSize });
        }
        return !!isValidFileSize && isValidTotalFileSize;
    };
    /**
     * @param {?} size
     * @return {?}
     */
    FilePickerComponent.prototype.bitsToMb = /**
     * @param {?} size
     * @return {?}
     */
    function (size) {
        return parseFloat(size) / 1048576;
    };
    /** when crop button submitted */
    /**
     * when crop button submitted
     * @return {?}
     */
    FilePickerComponent.prototype.onCropSubmit = /**
     * when crop button submitted
     * @return {?}
     */
    function () {
        this.cropper.getCroppedCanvas().toBlob(this.blobFallBack.bind(this), 'image/jpeg');
    };
    /** After crop submit */
    /**
     * After crop submit
     * @param {?} blob
     * @return {?}
     */
    FilePickerComponent.prototype.blobFallBack = /**
     * After crop submit
     * @param {?} blob
     * @return {?}
     */
    function (blob) {
        if (!blob) {
            return;
        }
        if (this.isValidSize((/** @type {?} */ (blob)), blob.size)) {
            this.pushFile((/** @type {?} */ (blob)), this.currentCropperFile.name);
        }
        this.closeCropper({ file: (/** @type {?} */ (blob)), fileName: this.currentCropperFile.name });
    };
    /**
     * @param {?} fileItem
     * @return {?}
     */
    FilePickerComponent.prototype.removeFile = /**
     * @param {?} fileItem
     * @return {?}
     */
    function (fileItem) {
        var _this = this;
        if (this.adapter) {
            this.adapter.removeFile(fileItem)
                .subscribe((/**
             * @param {?} res
             * @return {?}
             */
            function (res) {
                _this.onRemoveSuccess(fileItem);
            }));
        }
        else {
            console.warn('no adapter was provided');
        }
    };
    /** Emits event when file remove api returns success  */
    /**
     * Emits event when file remove api returns success
     * @param {?} fileItem
     * @return {?}
     */
    FilePickerComponent.prototype.onRemoveSuccess = /**
     * Emits event when file remove api returns success
     * @param {?} fileItem
     * @return {?}
     */
    function (fileItem) {
        this.removeSuccess.next(fileItem);
        this.removeFileFromList(fileItem);
    };
    FilePickerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ngx-file-picker',
                    template: "\n   <div (click)=\"fileInput.click()\" class=\"file-drop-wrapper\" *ngIf=\"showeDragDropZone\">\n      <file-drop\n        (onFileDrop)=\"dropped($event)\"\n        [customstyle]=\"'custom-drag'\"\n        [captions]=\"_captions\"\n      >\n      <ng-content select=\".dropzoneTemplate\"> </ng-content>\n      </file-drop>\n    </div>\n\n\n    <input type=\"file\" name=\"file[]\" id=\"fileInput\"\n           #fileInput\n           [multiple]=\"uploadType === 'multi' ? 'multiple' : '' \"\n           (click)=\"fileInput.value = null\"\n           (change)=\"onChange(fileInput)\"\n           [accept]=\"accept\"\n           class=\"file-input\"\n          >\n\n    <div class=\"cropperJsOverlay\" *ngIf=\"currentCropperFile\">\n     <div class=\"cropperJsBox\">\n     <img [src]=\"safeCropImgUrl\" id=\"cropper-img\" (load) = \"cropperImgLoaded($event)\">\n        <div class=\"cropper-actions\">\n        <button class=\"cropSubmit\" (click)=\"onCropSubmit()\">{{_captions?.cropper?.crop}}</button>\n        <button class=\"cropCancel\" (click)=\"closeCropper({file: currentCropperFile, fileName: currentCropperFile.name})\">\n        {{_captions?.cropper?.cancel}}\n        </button> </div>\n      </div>\n    </div>\n    <div class=\"files-preview-wrapper\" *ngIf=\"showPreviewContainer\">\n      <file-preview-container *ngIf=\"files\"\n      [previewFiles]=\"files\"\n      (removeFile)=\"removeFile($event)\"\n      (uploadSuccess)=\"onUploadSuccess($event)\"\n      [adapter]=\"adapter\"\n      [itemTemplate]=\"itemTemplate\"\n      [captions]=\"_captions\"\n      > </file-preview-container>\n    </div>\n\n  ",
                    styles: ["*{box-sizing:border-box}:host{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-align:center;align-items:center;width:100%;height:100%;overflow:auto;max-width:440px;border-radius:6px}.files-preview-wrapper{width:100%}#cropper-img{max-width:60vw}#cropper-img img{width:100%;height:100%}.file-drop-wrapper{width:100%;background:#fafbfd;padding-top:20px}.preview-container{display:-webkit-box;display:flex}.cropperJsOverlay{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;position:fixed;z-index:999;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,.32)}.cropperJsBox{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;max-height:calc(100vh - 38px - 50px);max-width:90vw}.cropperJsBox .cropper-actions{display:-webkit-box;display:flex}.cropperJsBox .cropper-actions button{margin:5px;padding:12px 25px;border-radius:6px;border:0;cursor:pointer}.cropperJsBox .cropper-actions .cropSubmit{color:#fff;background:#16a085}::ng-deep.cropper img{max-height:300px!important}#images{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;width:500px;overflow-x:auto}#images .image{-webkit-box-flex:0;flex:0 0 100px;margin:0 2px;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-align:end;align-items:flex-end}#fileInput{display:none}.uploader-submit-btn{background:#ffd740;color:rgba(0,0,0,.87);border:0;padding:0 16px;line-height:36px;font-size:15px;margin-top:12px;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}button:disabled{color:rgba(0,0,0,.26);background:#dcdcdc}"]
                }] }
    ];
    /** @nocollapse */
    FilePickerComponent.ctorParameters = function () { return [
        { type: FilePickerService },
        { type: ElementRef }
    ]; };
    FilePickerComponent.propDecorators = {
        uploadSuccess: [{ type: Output }],
        removeSuccess: [{ type: Output }],
        validationError: [{ type: Output }],
        fileAdded: [{ type: Output }],
        customValidator: [{ type: Input }],
        enableCropper: [{ type: Input }],
        showeDragDropZone: [{ type: Input }],
        showPreviewContainer: [{ type: Input }],
        itemTemplate: [{ type: Input }],
        uploadType: [{ type: Input }],
        fileMaxSize: [{ type: Input }],
        fileMaxCount: [{ type: Input }],
        totalMaxSize: [{ type: Input }],
        accept: [{ type: Input }],
        fileExtensions: [{ type: Input }],
        cropperOptions: [{ type: Input }],
        adapter: [{ type: Input }],
        dropzoneTemplate: [{ type: Input }],
        captions: [{ type: Input }]
    };
    return FilePickerComponent;
}());
export { FilePickerComponent };
if (false) {
    /**
     * Emitted when file is uploaded via api successfully. Emitted for every file
     * @type {?}
     */
    FilePickerComponent.prototype.uploadSuccess;
    /**
     * Emitted when file is removed via api successfully. Emitted for every file
     * @type {?}
     */
    FilePickerComponent.prototype.removeSuccess;
    /**
     * Emitted on file validation fail
     * @type {?}
     */
    FilePickerComponent.prototype.validationError;
    /**
     * Emitted when file is added and passed validations. Not uploaded yet
     * @type {?}
     */
    FilePickerComponent.prototype.fileAdded;
    /**
     * Custom validator function
     * @type {?}
     */
    FilePickerComponent.prototype.customValidator;
    /**
     * Whether to enable cropper. Default: disabled
     * @type {?}
     */
    FilePickerComponent.prototype.enableCropper;
    /**
     * Whether to show default drag and drop zone. Default:true
     * @type {?}
     */
    FilePickerComponent.prototype.showeDragDropZone;
    /**
     * Whether to show default files preview container. Default: true
     * @type {?}
     */
    FilePickerComponent.prototype.showPreviewContainer;
    /**
     * Preview Item template
     * @type {?}
     */
    FilePickerComponent.prototype.itemTemplate;
    /**
     * Single or multiple. Default: multi
     * @type {?}
     */
    FilePickerComponent.prototype.uploadType;
    /**
     * Max size of selected file in MB. Default: no limit
     * @type {?}
     */
    FilePickerComponent.prototype.fileMaxSize;
    /**
     * Max count of file in multi-upload. Default: no limit
     * @type {?}
     */
    FilePickerComponent.prototype.fileMaxCount;
    /**
     * Total Max size limit of all files in MB. Default: no limit
     * @type {?}
     */
    FilePickerComponent.prototype.totalMaxSize;
    /**
     * Which file types to show on choose file dialog. Default: show all
     * @type {?}
     */
    FilePickerComponent.prototype.accept;
    /** @type {?} */
    FilePickerComponent.prototype.files;
    /**
     * File extensions filter
     * @type {?}
     */
    FilePickerComponent.prototype.fileExtensions;
    /** @type {?} */
    FilePickerComponent.prototype.cropper;
    /**
     * Cropper options.
     * @type {?}
     */
    FilePickerComponent.prototype.cropperOptions;
    /**
     * Files array for cropper. Will be shown equentially if crop enabled
     * @type {?}
     */
    FilePickerComponent.prototype.filesForCropper;
    /**
     * Current file to be shown in cropper
     * @type {?}
     */
    FilePickerComponent.prototype.currentCropperFile;
    /**
     * Custom api Adapter for uploading/removing files
     * @type {?}
     */
    FilePickerComponent.prototype.adapter;
    /**
     * Custome template for dropzone
     * @type {?}
     */
    FilePickerComponent.prototype.dropzoneTemplate;
    /**
     * Custom captions input. Used for multi language support
     * @type {?}
     */
    FilePickerComponent.prototype.captions;
    /**
     * captions object
     * @type {?}
     */
    FilePickerComponent.prototype._captions;
    /** @type {?} */
    FilePickerComponent.prototype.cropClosed$;
    /** @type {?} */
    FilePickerComponent.prototype._onDestroy$;
    /** @type {?} */
    FilePickerComponent.prototype.safeCropImgUrl;
    /**
     * @type {?}
     * @private
     */
    FilePickerComponent.prototype.fileService;
    /**
     * @type {?}
     * @private
     */
    FilePickerComponent.prototype.elementRef;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsZS1waWNrZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vbmd4LWF3ZXNvbWUtdXBsb2FkZXIvIiwic291cmNlcyI6WyJsaWIvZmlsZS1waWNrZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sdUJBQXVCLENBQUM7QUFDeEQsT0FBTyxFQUFDLFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBcUIsTUFBTSxFQUFFLFdBQVcsRUFBb0IsTUFBTSxlQUFlLENBQUM7QUFHcEksT0FBTyxFQUFDLFdBQVcsRUFBQyxNQUFNLHFCQUFxQixDQUFDO0FBQ2hELE9BQU8sRUFBQyxtQkFBbUIsRUFBa0IsTUFBTSwwQkFBMEIsQ0FBQztBQUM5RSxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSx1QkFBdUIsQ0FBQztBQUV4RCxPQUFPLEVBQUMsYUFBYSxFQUFjLEVBQUUsRUFBRSxPQUFPLEVBQUMsTUFBTSxNQUFNLENBQUM7QUFDNUQsT0FBTyxFQUFDLEdBQUcsRUFBRSxTQUFTLEVBQUUsR0FBRyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDbkQsT0FBTyxFQUFDLGVBQWUsRUFBQyxNQUFNLG9CQUFvQixDQUFDO0FBSW5EO0lBd0dFLDZCQUFvQixXQUE4QixFQUN2QyxVQUFzQjtRQURiLGdCQUFXLEdBQVgsV0FBVyxDQUFtQjtRQUN2QyxlQUFVLEdBQVYsVUFBVSxDQUFZOzs7O1FBeER2QixrQkFBYSxHQUFHLElBQUksWUFBWSxFQUFvQixDQUFDOzs7O1FBRXJELGtCQUFhLEdBQUcsSUFBSSxZQUFZLEVBQW9CLENBQUM7Ozs7UUFFckQsb0JBQWUsR0FBRyxJQUFJLFlBQVksRUFBbUIsQ0FBQzs7OztRQUV0RCxjQUFTLEdBQUcsSUFBSSxZQUFZLEVBQW9CLENBQUM7Ozs7UUFLMUQsa0JBQWEsR0FBRyxLQUFLLENBQUM7Ozs7UUFFZCxzQkFBaUIsR0FB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O2lDQUlMLEtBQUs7aUNBR0wsS0FBSzswQkFNTCxLQUFLO21DQUdKLEtBQUs7MkJBRUwsS0FBSzs7SUFxUFQsMEJBQUM7Q0FBQSxBQXZWRCxJQXVWQztTQXhTWSxtQkFBbUI7Ozs7OztJQUU5Qiw0Q0FBK0Q7Ozs7O0lBRS9ELDRDQUErRDs7Ozs7SUFFL0QsOENBQWdFOzs7OztJQUVoRSx3Q0FBMkQ7Ozs7O0lBRTNELDhDQUE4RDs7Ozs7SUFFOUQsNENBQ3VCOzs7OztJQUV2QixnREFBa0M7Ozs7O0lBRWxDLG1EQUFxQzs7Ozs7SUFFckMsMkNBQXdDOzs7OztJQUV4Qyx5Q0FDc0I7Ozs7O0lBRXRCLDBDQUNxQjs7Ozs7SUFFckIsMkNBQ3NCOzs7OztJQUV0QiwyQ0FDc0I7Ozs7O0lBRXRCLHFDQUNlOztJQUNmLG9DQUErQjs7Ozs7SUFFL0IsNkNBQWtDOztJQUNsQyxzQ0FBYTs7Ozs7SUFFYiw2Q0FBZ0M7Ozs7O0lBRWhDLDhDQUE2Qjs7Ozs7SUFFNUIsaURBQXlCOzs7OztJQUUxQixzQ0FDNEI7Ozs7O0lBRTNCLCtDQUE0Qzs7Ozs7SUFFNUMsdUNBQW9DOzs7OztJQUVwQyx3Q0FBNEI7O0lBQzVCLDBDQUE4Qzs7SUFDOUMsMENBQWtDOztJQUNsQyw2Q0FBZ0M7Ozs7O0lBQ3JCLDBDQUFzQzs7Ozs7SUFDL0MseUNBQThCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtGaWxlUGlja2VyU2VydmljZX0gZnJvbSAnLi9maWxlLXBpY2tlci5zZXJ2aWNlJztcclxuaW1wb3J0IHtDb21wb25lbnQsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uRGVzdHJveSwgT25Jbml0LCBPdXRwdXQsIFRlbXBsYXRlUmVmLCBDaGFuZ2VEZXRlY3RvclJlZn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7U2FmZVJlc291cmNlVXJsfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcclxuaW1wb3J0IHtGaWxlUHJldmlld01vZGVsfSBmcm9tICcuL2ZpbGUtcHJldmlldy5tb2RlbCc7XHJcbmltcG9ydCB7Z2V0RmlsZVR5cGV9IGZyb20gJy4vZmlsZS11cGxvYWQudXRpbHMnO1xyXG5pbXBvcnQge0ZpbGVWYWxpZGF0aW9uVHlwZXMsIFZhbGlkYXRpb25FcnJvcn0gZnJvbSAnLi92YWxpZGF0aW9uLWVycm9yLm1vZGVsJztcclxuaW1wb3J0IHtGaWxlUGlja2VyQWRhcHRlcn0gZnJvbSAnLi9maWxlLXBpY2tlci5hZGFwdGVyJztcclxuaW1wb3J0IHtGaWxlU3lzdGVtRGlyZWN0b3J5RW50cnksIEZpbGVTeXN0ZW1GaWxlRW50cnksIFVwbG9hZEV2ZW50fSBmcm9tICcuL2ZpbGUtZHJvcCc7XHJcbmltcG9ydCB7Y29tYmluZUxhdGVzdCwgT2JzZXJ2YWJsZSwgb2YsIFN1YmplY3R9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQge21hcCwgdGFrZVVudGlsLCB0YXB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHtEZWZhdWx0Q2FwdGlvbnN9IGZyb20gJy4vZGVmYXVsdC1jYXB0aW9ucyc7XHJcbmltcG9ydCB7VXBsb2FkZXJDYXB0aW9uc30gZnJvbSAnLi91cGxvYWRlci1jYXB0aW9ucyc7XHJcblxyXG5kZWNsYXJlIHZhciBDcm9wcGVyO1xyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ25neC1maWxlLXBpY2tlcicsXHJcbiAgdGVtcGxhdGU6IGBcclxuICAgPGRpdiAoY2xpY2spPVwiZmlsZUlucHV0LmNsaWNrKClcIiBjbGFzcz1cImZpbGUtZHJvcC13cmFwcGVyXCIgKm5nSWY9XCJzaG93ZURyYWdEcm9wWm9uZVwiPlxyXG4gICAgICA8ZmlsZS1kcm9wXHJcbiAgICAgICAgKG9uRmlsZURyb3ApPVwiZHJvcHBlZCgkZXZlbnQpXCJcclxuICAgICAgICBbY3VzdG9tc3R5bGVdPVwiJ2N1c3RvbS1kcmFnJ1wiXHJcbiAgICAgICAgW2NhcHRpb25zXT1cIl9jYXB0aW9uc1wiXHJcbiAgICAgID5cclxuICAgICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwiLmRyb3B6b25lVGVtcGxhdGVcIj4gPC9uZy1jb250ZW50PlxyXG4gICAgICA8L2ZpbGUtZHJvcD5cclxuICAgIDwvZGl2PlxyXG5cclxuXHJcbiAgICA8aW5wdXQgdHlwZT1cImZpbGVcIiBuYW1lPVwiZmlsZVtdXCIgaWQ9XCJmaWxlSW5wdXRcIlxyXG4gICAgICAgICAgICNmaWxlSW5wdXRcclxuICAgICAgICAgICBbbXVsdGlwbGVdPVwidXBsb2FkVHlwZSA9PT0gJ211bHRpJyA/ICdtdWx0aXBsZScgOiAnJyBcIlxyXG4gICAgICAgICAgIChjbGljayk9XCJmaWxlSW5wdXQudmFsdWUgPSBudWxsXCJcclxuICAgICAgICAgICAoY2hhbmdlKT1cIm9uQ2hhbmdlKGZpbGVJbnB1dClcIlxyXG4gICAgICAgICAgIFthY2NlcHRdPVwiYWNjZXB0XCJcclxuICAgICAgICAgICBjbGFzcz1cImZpbGUtaW5wdXRcIlxyXG4gICAgICAgICAgPlxyXG5cclxuICAgIDxkaXYgY2xhc3M9XCJjcm9wcGVySnNPdmVybGF5XCIgKm5nSWY9XCJjdXJyZW50Q3JvcHBlckZpbGVcIj5cclxuICAgICA8ZGl2IGNsYXNzPVwiY3JvcHBlckpzQm94XCI+XHJcbiAgICAgPGltZyBbc3JjXT1cInNhZmVDcm9wSW1nVXJsXCIgaWQ9XCJjcm9wcGVyLWltZ1wiIChsb2FkKSA9IFwiY3JvcHBlckltZ0xvYWRlZCgkZXZlbnQpXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cImNyb3BwZXItYWN0aW9uc1wiPlxyXG4gICAgICAgIDxidXR0b24gY2xhc3M9XCJjcm9wU3VibWl0XCIgKGNsaWNrKT1cIm9uQ3JvcFN1Ym1pdCgpXCI+e3tfY2FwdGlvbnM/LmNyb3BwZXI/LmNyb3B9fTwvYnV0dG9uPlxyXG4gICAgICAgIDxidXR0b24gY2xhc3M9XCJjcm9wQ2FuY2VsXCIgKGNsaWNrKT1cImNsb3NlQ3JvcHBlcih7ZmlsZTogY3VycmVudENyb3BwZXJGaWxlLCBmaWxlTmFtZTogY3VycmVudENyb3BwZXJGaWxlLm5hbWV9KVwiPlxyXG4gICAgICAgIHt7X2NhcHRpb25zPy5jcm9wcGVyPy5jYW5jZWx9fVxyXG4gICAgICAgIDwvYnV0dG9uPiA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICAgIDxkaXYgY2xhc3M9XCJmaWxlcy1wcmV2aWV3LXdyYXBwZXJcIiAqbmdJZj1cInNob3dQcmV2aWV3Q29udGFpbmVyXCI+XHJcbiAgICAgIDxmaWxlLXByZXZpZXctY29udGFpbmVyICpuZ0lmPVwiZmlsZXNcIlxyXG4gICAgICBbcHJldmlld0ZpbGVzXT1cImZpbGVzXCJcclxuICAgICAgKHJlbW92ZUZpbGUpPVwicmVtb3ZlRmlsZSgkZXZlbnQpXCJcclxuICAgICAgKHVwbG9hZFN1Y2Nlc3MpPVwib25VcGxvYWRTdWNjZXNzKCRldmVudClcIlxyXG4gICAgICBbYWRhcHRlcl09XCJhZGFwdGVyXCJcclxuICAgICAgW2l0ZW1UZW1wbGF0ZV09XCJpdGVtVGVtcGxhdGVcIlxyXG4gICAgICBbY2FwdGlvbnNdPVwiX2NhcHRpb25zXCJcclxuICAgICAgPiA8L2ZpbGUtcHJldmlldy1jb250YWluZXI+XHJcbiAgICA8L2Rpdj5cclxuXHJcbiAgYCxcclxuICBzdHlsZVVybHM6IFsnLi9maWxlLXBpY2tlci5jb21wb25lbnQuc2NzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGaWxlUGlja2VyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xyXG4gIC8qKiBFbWl0dGVkIHdoZW4gZmlsZSBpcyB1cGxvYWRlZCB2aWEgYXBpIHN1Y2Nlc3NmdWxseS4gRW1pdHRlZCBmb3IgZXZlcnkgZmlsZSAqL1xyXG4gIEBPdXRwdXQoKSB1cGxvYWRTdWNjZXNzID0gbmV3IEV2ZW50RW1pdHRlcjxGaWxlUHJldmlld01vZGVsPigpO1xyXG4gIC8qKiBFbWl0dGVkIHdoZW4gZmlsZSBpcyByZW1vdmVkIHZpYSBhcGkgc3VjY2Vzc2Z1bGx5LiBFbWl0dGVkIGZvciBldmVyeSBmaWxlICovXHJcbiAgQE91dHB1dCgpIHJlbW92ZVN1Y2Nlc3MgPSBuZXcgRXZlbnRFbWl0dGVyPEZpbGVQcmV2aWV3TW9kZWw+KCk7XHJcbiAgLyoqIEVtaXR0ZWQgb24gZmlsZSB2YWxpZGF0aW9uIGZhaWwgKi9cclxuICBAT3V0cHV0KCkgdmFsaWRhdGlvbkVycm9yID0gbmV3IEV2ZW50RW1pdHRlcjxWYWxpZGF0aW9uRXJyb3I+KCk7XHJcbiAgLyoqIEVtaXR0ZWQgd2hlbiBmaWxlIGlzIGFkZGVkIGFuZCBwYXNzZWQgdmFsaWRhdGlvbnMuIE5vdCB1cGxvYWRlZCB5ZXQgKi9cclxuICBAT3V0cHV0KCkgZmlsZUFkZGVkID0gbmV3IEV2ZW50RW1pdHRlcjxGaWxlUHJldmlld01vZGVsPigpO1xyXG4gIC8qKiBDdXN0b20gdmFsaWRhdG9yIGZ1bmN0aW9uICovXHJcbiAgQElucHV0KCkgY3VzdG9tVmFsaWRhdG9yOiAoZmlsZTogRmlsZSkgPT4gT2JzZXJ2YWJsZTxib29sZWFuPjtcclxuICAvKiogV2hldGhlciB0byBlbmFibGUgY3JvcHBlci4gRGVmYXVsdDogZGlzYWJsZWQgKi9cclxuICBASW5wdXQoKVxyXG4gICBlbmFibGVDcm9wcGVyID0gZmFsc2U7XHJcbiAgLyoqIFdoZXRoZXIgdG8gc2hvdyBkZWZhdWx0IGRyYWcgYW5kIGRyb3Agem9uZS4gRGVmYXVsdDp0cnVlICovXHJcbiAgQElucHV0KCkgc2hvd2VEcmFnRHJvcFpvbmUgPSB0cnVlO1xyXG4gICAvKiogV2hldGhlciB0byBzaG93IGRlZmF1bHQgZmlsZXMgcHJldmlldyBjb250YWluZXIuIERlZmF1bHQ6IHRydWUgKi9cclxuICBASW5wdXQoKSBzaG93UHJldmlld0NvbnRhaW5lciA9IHRydWU7XHJcbiAgIC8qKiBQcmV2aWV3IEl0ZW0gdGVtcGxhdGUgKi9cclxuICBASW5wdXQoKSBpdGVtVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgLyoqIFNpbmdsZSBvciBtdWx0aXBsZS4gRGVmYXVsdDogbXVsdGkgKi9cclxuICBASW5wdXQoKVxyXG4gICB1cGxvYWRUeXBlID0gJ211bHRpJztcclxuICAvKiogTWF4IHNpemUgb2Ygc2VsZWN0ZWQgZmlsZSBpbiBNQi4gRGVmYXVsdDogbm8gbGltaXQgKi9cclxuICBASW5wdXQoKVxyXG4gICBmaWxlTWF4U2l6ZTogbnVtYmVyO1xyXG4gIC8qKiBNYXggY291bnQgb2YgZmlsZSBpbiBtdWx0aS11cGxvYWQuIERlZmF1bHQ6IG5vIGxpbWl0ICovXHJcbiAgQElucHV0KClcclxuICAgZmlsZU1heENvdW50OiBudW1iZXI7XHJcbiAgLyoqIFRvdGFsIE1heCBzaXplIGxpbWl0IG9mIGFsbCBmaWxlcyBpbiBNQi4gRGVmYXVsdDogbm8gbGltaXQgKi9cclxuICBASW5wdXQoKVxyXG4gICB0b3RhbE1heFNpemU6IG51bWJlcjtcclxuICAvKiogV2hpY2ggZmlsZSB0eXBlcyB0byBzaG93IG9uIGNob29zZSBmaWxlIGRpYWxvZy4gRGVmYXVsdDogc2hvdyBhbGwgKi9cclxuICBASW5wdXQoKVxyXG4gIGFjY2VwdDogc3RyaW5nO1xyXG4gIGZpbGVzOiBGaWxlUHJldmlld01vZGVsW10gPSBbXTtcclxuIC8qKiBGaWxlIGV4dGVuc2lvbnMgZmlsdGVyICovXHJcbiAgQElucHV0KCkgZmlsZUV4dGVuc2lvbnM6IFN0cmluZ1tdO1xyXG4gIGNyb3BwZXI6IGFueTtcclxuICAvKiogQ3JvcHBlciBvcHRpb25zLiAqL1xyXG4gIEBJbnB1dCgpIGNyb3BwZXJPcHRpb25zOiBPYmplY3Q7XHJcbiAgLyoqIEZpbGVzIGFycmF5IGZvciBjcm9wcGVyLiBXaWxsIGJlIHNob3duIGVxdWVudGlhbGx5IGlmIGNyb3AgZW5hYmxlZCAqL1xyXG4gIGZpbGVzRm9yQ3JvcHBlcjogRmlsZVtdID0gW107XHJcbiAgIC8qKiBDdXJyZW50IGZpbGUgdG8gYmUgc2hvd24gaW4gY3JvcHBlciovXHJcbiAgIGN1cnJlbnRDcm9wcGVyRmlsZTogRmlsZTtcclxuICAvKiogQ3VzdG9tIGFwaSBBZGFwdGVyIGZvciB1cGxvYWRpbmcvcmVtb3ZpbmcgZmlsZXMgKi9cclxuICBASW5wdXQoKVxyXG4gICBhZGFwdGVyOiBGaWxlUGlja2VyQWRhcHRlcjtcclxuICAvKiogIEN1c3RvbWUgdGVtcGxhdGUgZm9yIGRyb3B6b25lICovXHJcbiAgIEBJbnB1dCgpIGRyb3B6b25lVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XHJcbiAgLyoqIEN1c3RvbSBjYXB0aW9ucyBpbnB1dC4gVXNlZCBmb3IgbXVsdGkgbGFuZ3VhZ2Ugc3VwcG9ydCAqL1xyXG4gICBASW5wdXQoKSBjYXB0aW9uczogVXBsb2FkZXJDYXB0aW9ucztcclxuICAgLyoqIGNhcHRpb25zIG9iamVjdCovXHJcbiAgIF9jYXB0aW9uczogVXBsb2FkZXJDYXB0aW9ucztcclxuICAgY3JvcENsb3NlZCQgPSBuZXcgU3ViamVjdDxGaWxlUHJldmlld01vZGVsPigpO1xyXG4gICBfb25EZXN0cm95JCA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XHJcbiAgIHNhZmVDcm9wSW1nVXJsOiBTYWZlUmVzb3VyY2VVcmw7XHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBmaWxlU2VydmljZTogRmlsZVBpY2tlclNlcnZpY2UsXHJcbiAgICAgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmXHJcbiAgICAgKSB7XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuc2V0Q3JvcHBlck9wdGlvbnMoKTtcclxuICAgIHRoaXMubGlzdGVuVG9Dcm9wQ2xvc2UoKTtcclxuICAgIHRoaXMuc2V0Q2FwdGlvbnMoKTtcclxuICB9XHJcbiAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICB0aGlzLl9vbkRlc3Ryb3kkLm5leHQoKTtcclxuICB9XHJcbiAgc2V0Q2FwdGlvbnMoKSB7XHJcbiAgdGhpcy5fY2FwdGlvbnMgPSB0aGlzLmNhcHRpb25zIHx8IERlZmF1bHRDYXB0aW9ucztcclxuICB9XHJcbiAgLyoqIExpc3RlbiB3aGVuIENyb3BwZXIgaXMgY2xvc2VkIGFuZCBvcGVuIG5ldyBjcm9wcGVyIGlmIG5leHQgaW1hZ2UgZXhpc3RzICovXHJcbiAgbGlzdGVuVG9Dcm9wQ2xvc2UoKSB7XHJcbiAgICB0aGlzLmNyb3BDbG9zZWQkXHJcbiAgICAucGlwZSh0YWtlVW50aWwodGhpcy5fb25EZXN0cm95JCkpXHJcbiAgICAuc3Vic2NyaWJlKChyZXM6IEZpbGVQcmV2aWV3TW9kZWwpID0+IHtcclxuICAgICAgY29uc3QgY3JvcHBlZEluZGV4ID0gdGhpcy5maWxlc0ZvckNyb3BwZXIuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5uYW1lID09PSByZXMuZmlsZU5hbWUpO1xyXG4gICAgICBjb25zdCBuZXh0RmlsZSA9IGNyb3BwZWRJbmRleCAhPT0gLTEgPyB0aGlzLmZpbGVzRm9yQ3JvcHBlcltjcm9wcGVkSW5kZXggKyAxXSA6IHVuZGVmaW5lZDtcclxuICAgICAvLyBjb25zb2xlLmxvZyhuZXh0RmlsZSlcclxuICAvLyAgY29uc29sZS5sb2coJ2Nyb3BwZWQnLCByZXMpO1xyXG4gICAgICB0aGlzLmZpbGVzRm9yQ3JvcHBlciA9IFsuLi50aGlzLmZpbGVzRm9yQ3JvcHBlcl0uZmlsdGVyKGl0ZW0gPT4gaXRlbS5uYW1lICE9PSByZXMuZmlsZU5hbWUpO1xyXG4gICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuZmlsZXNGb3JDcm9wcGVyKTtcclxuICAgICAgaWYgKG5leHRGaWxlKSB7XHJcbiAgICAgICAgIHRoaXMub3BlbkNyb3BwZXIobmV4dEZpbGUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbi8qKiBTZXRzIGN1c3RvbSBjcm9wcGVyIG9wdGlvbnMgaWYgYXZhaWFibGUgKi9cclxuICBzZXRDcm9wcGVyT3B0aW9ucygpIHtcclxuICAgIGlmICghdGhpcy5jcm9wcGVyT3B0aW9ucykge1xyXG4gICAgdGhpcy5zZXREZWZhdWx0Q3JvcHBlck9wdGlvbnMoKTtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqIFNldHMgbWFudWFsIGNyb3BwZXIgb3B0aW9ucyBpZiBubyBjdXN0b20gb3B0aW9ucyBhcmUgYXZhaWFibGUgKi9cclxuICBzZXREZWZhdWx0Q3JvcHBlck9wdGlvbnMoKSB7XHJcbiAgICB0aGlzLmNyb3BwZXJPcHRpb25zID0ge1xyXG4gICAgICBkcmFnTW9kZTogJ2Nyb3AnLFxyXG4gICAgICBhc3BlY3RSYXRpbzogMSxcclxuICAgICAgYXV0b0Nyb3A6IHRydWUsXHJcbiAgICAgIG1vdmFibGU6IHRydWUsXHJcbiAgICAgIHpvb21hYmxlOiB0cnVlLFxyXG4gICAgICBzY2FsYWJsZTogdHJ1ZSxcclxuICAgICAgYXV0b0Nyb3BBcmVhOiAwLjhcclxuICAgIH07XHJcbiAgfVxyXG4gIC8qKiBPbiBpbnB1dCBmaWxlIHNlbGVjdGVkICovXHJcbiAgb25DaGFuZ2UoIGZpbGVJbnB1dDogSFRNTElucHV0RWxlbWVudCkge1xyXG4gICAgIGNvbnN0IGZpbGVzOiBGaWxlW10gPSAgQXJyYXkuZnJvbShmaWxlSW5wdXQuZmlsZXMpO1xyXG4gICAgdGhpcy5oYW5kbGVGaWxlcyhmaWxlcykuc3Vic2NyaWJlKCk7XHJcbiAgfVxyXG4gIC8qKiBIYW5kbGVzIGlucHV0IGFuZCBkcmFnL2Ryb3AgZmlsZXMgKi9cclxuICAgaGFuZGxlRmlsZXMoZmlsZXM6IEZpbGVbXSk6IE9ic2VydmFibGU8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmlzVmFsaWRNYXhGaWxlQ291bnQoZmlsZXMpKSB7cmV0dXJuIG9mKG51bGwpOyB9XHJcbiAgICBjb25zdCBpc1ZhbGlkVXBsb2FkU3luYyA9IGZpbGVzLmV2ZXJ5KGl0ZW0gPT4gdGhpcy52YWxpZGF0ZUZpbGVTeW5jKGl0ZW0pKTtcclxuICAgIGNvbnN0IGFzeW5jRnVuY3Rpb25zID0gZmlsZXMubWFwKGl0ZW0gPT4gdGhpcy52YWxpZGF0ZUZpbGVBc3luYyhpdGVtKSk7XHJcbiAgICByZXR1cm4gY29tYmluZUxhdGVzdCguLi5hc3luY0Z1bmN0aW9ucylcclxuICAgICAgLnBpcGUoXHJcbiAgICAgICAgbWFwKHJlcyA9PiB7XHJcbiAgICAgICAgICBjb25zdCBpc1ZhbGlkVXBsb2FkQXN5bmMgPSByZXMuZXZlcnkocmVzdWx0ID0+IHJlc3VsdCA9PT0gdHJ1ZSk7XHJcbiAgICAgICAgICBpZiAoIWlzVmFsaWRVcGxvYWRTeW5jIHx8ICFpc1ZhbGlkVXBsb2FkQXN5bmMpIHtyZXR1cm47IH1cclxuICAgICAgICAgIGZpbGVzLmZvckVhY2goKGZpbGU6IEZpbGUsIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVJbnB1dEZpbGUoZmlsZSwgaW5kZXggKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgfVxyXG4gIC8qKiBWYWxpZGF0ZXMgc3luY2hyb25vdXMgdmFsaWRhdGlvbnMgKi9cclxuICB2YWxpZGF0ZUZpbGVTeW5jKGZpbGU6IEZpbGUpOiBib29sZWFuIHtcclxuICAgIGlmICghZmlsZSkge3JldHVybjsgfVxyXG4gICAgaWYgKCF0aGlzLmlzVmFsaWRVcGxvYWRUeXBlKGZpbGUpKSB7cmV0dXJuOyB9XHJcbiAgICBpZiAoIXRoaXMuaXNWYWxpZEV4dGVuc2lvbihmaWxlLCBmaWxlLm5hbWUpKSB7cmV0dXJuOyB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcbiAgLyoqIFZhbGlkYXRlcyBhc3luY2hyb25vdXMgdmFsaWRhdGlvbnMgKi9cclxuICB2YWxpZGF0ZUZpbGVBc3luYyhmaWxlOiBGaWxlKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XHJcbiAgICBpZiAoIXRoaXMuY3VzdG9tVmFsaWRhdG9yKSB7cmV0dXJuIG9mKHRydWUpOyB9XHJcbiAgICByZXR1cm4gdGhpcy5jdXN0b21WYWxpZGF0b3IoZmlsZSkucGlwZShcclxuICAgICAgdGFwKHJlcyA9PiB7XHJcbiAgICAgICAgaWYgKCFyZXMpIHsgdGhpcy52YWxpZGF0aW9uRXJyb3IubmV4dCh7ZmlsZTogZmlsZSwgZXJyb3I6IEZpbGVWYWxpZGF0aW9uVHlwZXMuY3VzdG9tVmFsaWRhdG9yfSk7IH1cclxuICAgICAgfSlcclxuICAgICk7XHJcbiAgfVxyXG4gIC8qKiBIYW5kbGVzIGlucHV0IGFuZCBkcmFnJmRyb3AgZmlsZXMgKi9cclxuICBoYW5kbGVJbnB1dEZpbGUoZmlsZTogRmlsZSwgaW5kZXgpOiB2b2lkIHtcclxuICAgIGNvbnN0IHR5cGUgPSBnZXRGaWxlVHlwZShmaWxlLnR5cGUpO1xyXG4gICAgaWYgKHR5cGUgPT09ICdpbWFnZScgJiYgdGhpcy5lbmFibGVDcm9wcGVyKSB7XHJcbiAgICAgIHRoaXMuZmlsZXNGb3JDcm9wcGVyLnB1c2goZmlsZSk7XHJcbiAgICAgIGlmICghKHRoaXMuY3VycmVudENyb3BwZXJGaWxlKSkge1xyXG4gICAgICAgIHRoaXMub3BlbkNyb3BwZXIoZmlsZSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8qKiBTaXplIGlzIG5vdCBpbml0aWFsbHkgY2hlY2tlZCBvbiBoYW5kbGVJbnB1dEZpbGVzIGJlY2F1c2Ugb2YgY3JvcHBlciBzaXplIGNoYW5nZSAqL1xyXG4gICAgICAgaWYgKHRoaXMuaXNWYWxpZFNpemUoZmlsZSwgZmlsZS5zaXplKSkge1xyXG4gICAgICAgIHRoaXMucHVzaEZpbGUoZmlsZSk7XHJcbiAgICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKiBWYWxpZGF0ZXMgaWYgdXBsb2FkIHR5cGUgaXMgc2luZ2xlIHNvIGFub3RoZXIgZmlsZSBjYW5ub3QgYmUgYWRkZWQgKi9cclxuICBpc1ZhbGlkVXBsb2FkVHlwZShmaWxlKTogYm9vbGVhbiB7XHJcbiAgICBpZiAodGhpcy51cGxvYWRUeXBlID09PSAnc2luZ2xlJyAmJiB0aGlzLmZpbGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgdGhpcy52YWxpZGF0aW9uRXJyb3IubmV4dCh7ZmlsZTogZmlsZSwgZXJyb3I6IEZpbGVWYWxpZGF0aW9uVHlwZXMudXBsb2FkVHlwZX0pO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqIFZhbGlkYXRlcyBtYXggZmlsZSBjb3VudCAqL1xyXG4gIGlzVmFsaWRNYXhGaWxlQ291bnQoZmlsZXM6IEZpbGVbXSk6IGJvb2xlYW4ge1xyXG4gICAgaWYgKCF0aGlzLmZpbGVNYXhDb3VudCB8fCB0aGlzLmZpbGVNYXhDb3VudCA+PSB0aGlzLmZpbGVzLmxlbmd0aCArIGZpbGVzLmxlbmd0aCApIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgfSBlbHNlIHtcclxuICAgICAgIHRoaXMudmFsaWRhdGlvbkVycm9yLm5leHQoe2ZpbGU6IG51bGwsIGVycm9yOiBGaWxlVmFsaWRhdGlvblR5cGVzLmZpbGVNYXhDb3VudH0pO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgfVxyXG4gIH1cclxuICAvKiogT24gZmlsZSBkcm9wcGVkICovXHJcbiAgZHJvcHBlZChldmVudDogVXBsb2FkRXZlbnQpIHtcclxuICAgIGNvbnN0IGZpbGVzID0gZXZlbnQuZmlsZXM7XHJcbiAgICBjb25zdCBmaWxlc0ZvclVwbG9hZDogRmlsZVtdID0gW107XHJcbiAgICBmb3IgKGNvbnN0IGRyb3BwZWRGaWxlIG9mIGV2ZW50LmZpbGVzKSB7XHJcbiAgICAgIC8vIElzIGl0IGEgZmlsZT9cclxuICAgICAgaWYgKGRyb3BwZWRGaWxlLmZpbGVFbnRyeS5pc0ZpbGUpIHtcclxuICAgICAgICBjb25zdCBmaWxlRW50cnkgPSBkcm9wcGVkRmlsZS5maWxlRW50cnkgYXMgRmlsZVN5c3RlbUZpbGVFbnRyeTtcclxuICAgICAgICBmaWxlRW50cnkuZmlsZSgoZmlsZTogRmlsZSkgPT4ge1xyXG4gICAgICAgICAgZmlsZXNGb3JVcGxvYWQucHVzaChmaWxlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBJdCB3YXMgYSBkaXJlY3RvcnkgKGVtcHR5IGRpcmVjdG9yaWVzIGFyZSBhZGRlZCwgb3RoZXJ3aXNlIG9ubHkgZmlsZXMpXHJcbiAgICAgICAgY29uc3QgZmlsZUVudHJ5ID0gZHJvcHBlZEZpbGUuZmlsZUVudHJ5IGFzIEZpbGVTeXN0ZW1EaXJlY3RvcnlFbnRyeTtcclxuICAgICAgIC8vIGNvbnNvbGUubG9nKGRyb3BwZWRGaWxlLnJlbGF0aXZlUGF0aCwgZmlsZUVudHJ5KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmhhbmRsZUZpbGVzKGZpbGVzRm9yVXBsb2FkKS5zdWJzY3JpYmUoKSk7XHJcbiAgfVxyXG4gIC8qKiBBZGQgZmlsZSB0byBmaWxlIGxpc3QgYWZ0ZXIgc3VjY2VzZnVsbCB2YWxpZGF0aW9uICovXHJcbiAgcHVzaEZpbGUoIGZpbGU6IEZpbGUsIGZpbGVOYW1lID0gZmlsZS5uYW1lKTogdm9pZCB7XHJcbiAgICAgIHRoaXMuZmlsZXMucHVzaCh7IGZpbGU6IGZpbGUsIGZpbGVOYW1lOiBmaWxlTmFtZX0pO1xyXG4gICAgICB0aGlzLmZpbGVBZGRlZC5uZXh0KHsgZmlsZTogZmlsZSwgZmlsZU5hbWU6IGZpbGVOYW1lfSk7XHJcbiAgfVxyXG4gIC8qKiBPcGVucyBjcm9wcGVyIGZvciBpbWFnZSBjcm9wICovXHJcbiAgb3BlbkNyb3BwZXIoZmlsZTogRmlsZSk6IHZvaWQge1xyXG4gICAgaWYgKCg8YW55PndpbmRvdykuVVBMT0FERVJfVEVTVF9NT0RFIHx8IHR5cGVvZiBDcm9wcGVyICE9PSAndW5kZWZpbmVkJyApIHtcclxuICAgICAgdGhpcy5zYWZlQ3JvcEltZ1VybCA9IHRoaXMuZmlsZVNlcnZpY2UuY3JlYXRlU2FmZVVybChmaWxlKTtcclxuICAgICAgdGhpcy5jdXJyZW50Q3JvcHBlckZpbGUgPSBmaWxlO1xyXG4gICAgfSBlbHNlICB7XHJcbiAgICAgIGNvbnNvbGUud2FybigncGxlYXNlIGltcG9ydCBjcm9wcGVyanMgc2NyaXB0IGFuZCBzdHlsZXMgdG8gdXNlIGNyb3BwZXIgZmVhdHVyZSBvciBkaXNhYmxlIGl0IGJ5IHNldHRpbmcgW2VuYWJsZUNyb3BwZXJdPVwiZmFsc2VcIicpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgfVxyXG4gIGdldFNhZmVVcmwoZmlsZTogRmlsZSk6IFNhZmVSZXNvdXJjZVVybCB7XHJcbiAgICByZXR1cm4gdGhpcy5maWxlU2VydmljZS5jcmVhdGVTYWZlVXJsKGZpbGUpO1xyXG4gIH1cclxuICAvKiogT24gaW1nIGxvYWQgZXZlbnQgKi9cclxuICBjcm9wcGVySW1nTG9hZGVkKGUpOiB2b2lkIHtcclxuICAgIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nyb3BwZXItaW1nJyk7XHJcbiAgICB0aGlzLmNyb3BwZXIgPSBuZXcgQ3JvcHBlcihpbWFnZSwgdGhpcy5jcm9wcGVyT3B0aW9ucyk7XHJcbiAgfVxyXG4gIC8qKiBDbG9zZSBvciBjYW5jZWwgY3JvcHBlciAqL1xyXG4gIGNsb3NlQ3JvcHBlcihmaWxlUHJldmlldzogRmlsZVByZXZpZXdNb2RlbCk6IHZvaWQge1xyXG4gICAgdGhpcy5jdXJyZW50Q3JvcHBlckZpbGUgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLmNyb3BwZXIgPSB1bmRlZmluZWQ7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuY3JvcENsb3NlZCQubmV4dChmaWxlUHJldmlldyksIDIwMCk7XHJcbiAgfVxyXG4vKiogUmVtb3ZlcyBmaWxlcyBmcm9tIGZpbGVzIGxpc3QgKi9cclxuICByZW1vdmVGaWxlRnJvbUxpc3QoZmlsZTogRmlsZVByZXZpZXdNb2RlbCk6IHZvaWQge1xyXG4gICAgdGhpcy5maWxlcyA9IHRoaXMuZmlsZXMuZmlsdGVyKGYgPT4gIGYgIT09IGZpbGUpO1xyXG4gIH1cclxuICAvKiogRW1pdHMgZXZlbnQgd2hlbiBmaWxlIHVwbG9hZCBhcGkgcmV0dXJucyBzdWNjZXNzICAqL1xyXG4gIG9uVXBsb2FkU3VjY2VzcyhmaWxlSXRlbTogRmlsZVByZXZpZXdNb2RlbCk6IHZvaWQge1xyXG4gICAgdGhpcy51cGxvYWRTdWNjZXNzLm5leHQoZmlsZUl0ZW0pO1xyXG4gIH1cclxuIC8qKiBWYWxpZGF0ZXMgZmlsZSBleHRlbnNpb24gKi9cclxuIGlzVmFsaWRFeHRlbnNpb24oZmlsZTogRmlsZSwgZmlsZU5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIGlmICghdGhpcy5maWxlRXh0ZW5zaW9ucykge3JldHVybiB0cnVlOyB9XHJcbiAgY29uc3QgZXh0ZW5zaW9uID0gZmlsZU5hbWUuc3BsaXQoJy4nKS5wb3AoKTtcclxuICBjb25zdCBmaWxlRXh0ZW5zaW9ucyA9IHRoaXMuZmlsZUV4dGVuc2lvbnMubWFwKGV4dCA9PiBleHQudG9Mb3dlckNhc2UoKSk7XHJcbiAgaWYgKGZpbGVFeHRlbnNpb25zLmluZGV4T2YoZXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCkpID09PSAtMSkge1xyXG4gICAgdGhpcy52YWxpZGF0aW9uRXJyb3IubmV4dCh7ZmlsZTogZmlsZSwgZXJyb3I6IEZpbGVWYWxpZGF0aW9uVHlwZXMuZXh0ZW5zaW9uc30pO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG4gICAvKiogVmFsaWRhdGVzIHNlbGVjdGVkIGZpbGUgc2l6ZSBhbmQgdG90YWwgZmlsZSBzaXplICovXHJcbiAgaXNWYWxpZFNpemUoZmlsZTogRmlsZSwgc2l6ZTogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICAvKiogVmFsaWRhdGluZyBzZWxlY3RlZCBmaWxlIHNpemUgKi9cclxuICAgIGNvbnN0IHJlczogbnVtYmVyID0gdGhpcy5iaXRzVG9NYihzaXplLnRvU3RyaW5nKCkpO1xyXG4gICAgbGV0IGlzVmFsaWRGaWxlU2l6ZTogYm9vbGVhbjtcclxuICAgIGxldCBpc1ZhbGlkVG90YWxGaWxlU2l6ZTogYm9vbGVhbjtcclxuICAgIGlmICAoIXRoaXMuZmlsZU1heFNpemUgfHwgKCB0aGlzLmZpbGVNYXhTaXplICYmIHJlcyA8IHRoaXMuZmlsZU1heFNpemUpKSB7XHJcbiAgICAgIGlzVmFsaWRGaWxlU2l6ZSA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnZhbGlkYXRpb25FcnJvci5uZXh0KHtmaWxlOiBmaWxlLCBlcnJvcjogRmlsZVZhbGlkYXRpb25UeXBlcy5maWxlTWF4U2l6ZX0pO1xyXG4gICAgfVxyXG4gICAgLyoqIFZhbGlkYXRpbmcgVG90YWwgRmlsZXMgU2l6ZSAqL1xyXG4gICAgY29uc3QgdG90YWxCaXRzID0gdGhpcy5maWxlcy5tYXAoZiA9PiBmLmZpbGUuc2l6ZSkucmVkdWNlKChhY2MsIGN1cnIpID0+IGFjYyArIGN1cnIsIDApO1xyXG4gICAgICBpZiAoIXRoaXMudG90YWxNYXhTaXplIHx8ICh0aGlzLnRvdGFsTWF4U2l6ZSAmJiB0aGlzLmJpdHNUb01iKHRvdGFsQml0cyArIGZpbGUuc2l6ZSkgPCB0aGlzLnRvdGFsTWF4U2l6ZSkpIHtcclxuICAgICAgICAgaXNWYWxpZFRvdGFsRmlsZVNpemUgPSB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMudmFsaWRhdGlvbkVycm9yLm5leHQoe2ZpbGU6IGZpbGUsIGVycm9yOiBGaWxlVmFsaWRhdGlvblR5cGVzLnRvdGFsTWF4U2l6ZX0pO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiAhIWlzVmFsaWRGaWxlU2l6ZSAmJiBpc1ZhbGlkVG90YWxGaWxlU2l6ZTtcclxuICB9XHJcbiAgYml0c1RvTWIoc2l6ZSk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gcGFyc2VGbG9hdChzaXplKSAvIDEwNDg1NzY7XHJcbiAgfVxyXG4gIC8qKiB3aGVuIGNyb3AgYnV0dG9uIHN1Ym1pdHRlZCAqL1xyXG4gIG9uQ3JvcFN1Ym1pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuY3JvcHBlci5nZXRDcm9wcGVkQ2FudmFzKCkudG9CbG9iKHRoaXMuYmxvYkZhbGxCYWNrLmJpbmQodGhpcyksICdpbWFnZS9qcGVnJyk7XHJcbiAgfVxyXG4gIC8qKiBBZnRlciBjcm9wIHN1Ym1pdCAqL1xyXG4gIGJsb2JGYWxsQmFjayhibG9iOiBCbG9iKTogdm9pZCB7XHJcbiAgICBpZiAoIWJsb2IpIHtyZXR1cm47fVxyXG4gICAgaWYgKHRoaXMuaXNWYWxpZFNpemUoPEZpbGU+YmxvYiwgYmxvYi5zaXplKSkge1xyXG4gICAgICB0aGlzLnB1c2hGaWxlKDxGaWxlPmJsb2IsIHRoaXMuY3VycmVudENyb3BwZXJGaWxlLm5hbWUpO1xyXG4gICAgfVxyXG4gICB0aGlzLmNsb3NlQ3JvcHBlcih7ZmlsZTogYmxvYiBhcyBGaWxlLCBmaWxlTmFtZTogdGhpcy5jdXJyZW50Q3JvcHBlckZpbGUubmFtZX0pO1xyXG4gIH1cclxuICByZW1vdmVGaWxlKGZpbGVJdGVtOiBGaWxlUHJldmlld01vZGVsKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5hZGFwdGVyKSB7XHJcbiAgICAgIHRoaXMuYWRhcHRlci5yZW1vdmVGaWxlKGZpbGVJdGVtKVxyXG4gICAgICAuc3Vic2NyaWJlKHJlcyA9PiB7XHJcbiAgICAgICAgdGhpcy5vblJlbW92ZVN1Y2Nlc3MoZmlsZUl0ZW0pO1xyXG4gICAgICB9KTtcclxuICAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ25vIGFkYXB0ZXIgd2FzIHByb3ZpZGVkJyk7XHJcbiAgICAgfVxyXG4gICB9XHJcbiAgICAvKiogRW1pdHMgZXZlbnQgd2hlbiBmaWxlIHJlbW92ZSBhcGkgcmV0dXJucyBzdWNjZXNzICAqL1xyXG4gIG9uUmVtb3ZlU3VjY2VzcyhmaWxlSXRlbTogRmlsZVByZXZpZXdNb2RlbCk6IHZvaWQge1xyXG4gICAgdGhpcy5yZW1vdmVTdWNjZXNzLm5leHQoZmlsZUl0ZW0pO1xyXG4gICAgdGhpcy5yZW1vdmVGaWxlRnJvbUxpc3QoZmlsZUl0ZW0pO1xyXG4gIH1cclxuXHJcblxyXG59XHJcbiJdfQ==