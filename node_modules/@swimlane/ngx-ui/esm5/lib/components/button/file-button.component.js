import { __decorate, __metadata } from "tslib";
import { Component, Input, Output, EventEmitter, NgZone, ViewEncapsulation, OnInit, ContentChild, TemplateRef, ViewChild, ElementRef, ChangeDetectionStrategy } from '@angular/core';
import { coerceBooleanProperty } from '@angular/cdk/coercion';
import { FileUploader } from '@swimlane/ng2-file-upload';
import { FileButtonStyleType } from './file-button-style.type';
var nextId = 0;
var FileButtonComponent = /** @class */ (function () {
    function FileButtonComponent(_ngZone) {
        this._ngZone = _ngZone;
        this.id = "input-" + ++nextId;
        this.styleType = FileButtonStyleType.standard;
        this.afterAddingFile = new EventEmitter();
        this.beforeUploadItem = new EventEmitter();
        this.successItem = new EventEmitter();
        this.errorItem = new EventEmitter();
        this.progressAll = new EventEmitter();
        this.FileButtonStyleType = FileButtonStyleType;
        this.progress = 0;
        this.fileName = '';
        this.fileOverDropzone = false;
        this._isItemSuccessful = false;
        this._disabled = false;
        this._multiple = false;
    }
    Object.defineProperty(FileButtonComponent.prototype, "disabled", {
        get: function () {
            return this._disabled;
        },
        set: function (disabled) {
            this._disabled = coerceBooleanProperty(disabled);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileButtonComponent.prototype, "multiple", {
        get: function () {
            return this._multiple;
        },
        set: function (multiple) {
            this._multiple = coerceBooleanProperty(multiple);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileButtonComponent.prototype, "isDisabled", {
        get: function () {
            return this.disabled || this.uploader.isUploading;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileButtonComponent.prototype, "cssClasses", {
        get: function () {
            return {
                'ngx-file-button': true,
                'standard-style': this.styleType === FileButtonStyleType.standard,
                'progress-style': this.styleType === FileButtonStyleType.progress,
                'show-progress': this.uploader && this.uploader.options.isHTML5,
                success: this._isItemSuccessful,
                active: this.uploader && this.uploader.isUploading
            };
        },
        enumerable: true,
        configurable: true
    });
    FileButtonComponent.prototype.ngOnInit = function () {
        var _this = this;
        this._ngZone.run(function () {
            if (!_this.uploader && !_this.options) {
                throw new Error('You must pass either an uploader instance or options.');
            }
            // if options were passed, init a new uploader
            if (!_this.uploader && _this.options) {
                _this.uploader = new FileUploader(_this.options);
            }
            // always remove after upload for this case
            _this.uploader.options.removeAfterUpload = true;
            _this.uploader.onAfterAddingFile = _this.onAfterAddingFile.bind(_this);
            _this.uploader.onBeforeUploadItem = _this.onBeforeUploadItem.bind(_this);
            _this.uploader.onProgressAll = _this.onProgressAll.bind(_this);
            _this.uploader.onSuccessItem = _this.onSuccessItem.bind(_this);
            _this.uploader.onErrorItem = _this.onErrorItem.bind(_this);
        });
    };
    FileButtonComponent.prototype.onAfterAddingFile = function (fileItem) {
        var _this = this;
        this._ngZone.run(function () {
            _this.fileName = fileItem.file.name;
            _this.afterAddingFile.emit({ fileItem: fileItem });
        });
    };
    FileButtonComponent.prototype.onBeforeUploadItem = function (fileItem) {
        var _this = this;
        this._ngZone.run(function () {
            _this.beforeUploadItem.emit({ fileItem: fileItem });
        });
    };
    FileButtonComponent.prototype.onErrorItem = function (response, status, headers) {
        this.errorItem.emit({ response: response, status: status, headers: headers });
    };
    FileButtonComponent.prototype.onProgressAll = function (progress) {
        var _this = this;
        this._ngZone.run(function () {
            _this.progress = progress;
            _this.progressAll.emit({ progress: progress });
        });
    };
    FileButtonComponent.prototype.onSuccessItem = function (item, response, status, headers) {
        var _this = this;
        this._ngZone.run(function () {
            _this._isItemSuccessful = true;
            setTimeout(function () {
                _this.fileName = '';
                _this._isItemSuccessful = false;
            }, 2500);
            _this.successItem.emit({ item: item, response: response, status: status, headers: headers });
        });
    };
    FileButtonComponent.prototype.fileOverBase = function (event) {
        this.fileOverDropzone = event;
    };
    FileButtonComponent.prototype.clearInput = function () {
        this.fileInput.nativeElement.value = '';
    };
    FileButtonComponent.ctorParameters = function () { return [
        { type: NgZone }
    ]; };
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], FileButtonComponent.prototype, "id", void 0);
    __decorate([
        Input(),
        __metadata("design:type", String)
    ], FileButtonComponent.prototype, "name", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], FileButtonComponent.prototype, "styleType", void 0);
    __decorate([
        Input(),
        __metadata("design:type", FileUploader)
    ], FileButtonComponent.prototype, "uploader", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], FileButtonComponent.prototype, "options", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object),
        __metadata("design:paramtypes", [Object])
    ], FileButtonComponent.prototype, "disabled", null);
    __decorate([
        Input(),
        __metadata("design:type", Object),
        __metadata("design:paramtypes", [Object])
    ], FileButtonComponent.prototype, "multiple", null);
    __decorate([
        Output(),
        __metadata("design:type", Object)
    ], FileButtonComponent.prototype, "afterAddingFile", void 0);
    __decorate([
        Output(),
        __metadata("design:type", Object)
    ], FileButtonComponent.prototype, "beforeUploadItem", void 0);
    __decorate([
        Output(),
        __metadata("design:type", Object)
    ], FileButtonComponent.prototype, "successItem", void 0);
    __decorate([
        Output(),
        __metadata("design:type", Object)
    ], FileButtonComponent.prototype, "errorItem", void 0);
    __decorate([
        Output(),
        __metadata("design:type", Object)
    ], FileButtonComponent.prototype, "progressAll", void 0);
    __decorate([
        ContentChild('dropzoneTemplate'),
        __metadata("design:type", TemplateRef)
    ], FileButtonComponent.prototype, "dropzoneTemplate", void 0);
    __decorate([
        ViewChild('fileInput'),
        __metadata("design:type", ElementRef)
    ], FileButtonComponent.prototype, "fileInput", void 0);
    FileButtonComponent = __decorate([
        Component({
            exportAs: 'ngxFileButton',
            selector: 'ngx-file-button',
            template: "<div\n  *ngIf=\"dropzoneTemplate\"\n  ng2FileDrop\n  [class.file-over]=\"fileOverDropzone\"\n  [uploader]=\"uploader\"\n  (fileOver)=\"fileOverBase($event)\"\n>\n  <ng-template ng2FileDrop [ngTemplateOutlet]=\"dropzoneTemplate\" [ngTemplateOutletContext]=\"{ $implicit: uploader }\">\n  </ng-template>\n</div>\n\n<div *ngIf=\"!dropzoneTemplate\" [ngClass]=\"cssClasses\">\n  <div class=\"ngx-file-button-button\">\n    <input\n      #fileInput\n      ng2FileSelect\n      type=\"file\"\n      class=\"ngx-file-button-input\"\n      [disabled]=\"isDisabled\"\n      [multiple]=\"multiple\"\n      [id]=\"id + '-input'\"\n      [name]=\"name + '-input'\"\n      [uploader]=\"uploader\"\n    />\n    <label\n      [class.disabled]=\"isDisabled\"\n      [class.btn]=\"styleType === FileButtonStyleType.standard\"\n      [attr.for]=\"id + '-input'\"\n      class=\"ngx-file-button-label\"\n    >\n      <ng-content></ng-content>\n    </label>\n    <span class=\"ngx-file-button-text\" *ngIf=\"fileName\">\n      {{ fileName }}\n    </span>\n  </div>\n  <div class=\"ngx-file-button-fill\" [style.width.%]=\"progress\"></div>\n  <span class=\"icon-check\"></span>\n</div>\n",
            encapsulation: ViewEncapsulation.None,
            changeDetection: ChangeDetectionStrategy.OnPush,
            styles: ["button{box-sizing:border-box;color:inherit;cursor:pointer;display:inline-block;position:relative;text-align:center;text-decoration:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font:inherit;background:0 0;border:none;text-shadow:1px 1px rgba(0,0,0,.07)}button:active,button:focus{outline:0}.btn{box-sizing:border-box;color:#fff;display:inline-block;padding:.35em .55em;position:relative;text-align:center;text-decoration:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font:inherit;font-size:.9em;font-weight:700;outline:0;line-height:1em;background:#455066;border:1px solid transparent;border-radius:2px;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);-webkit-transition:background-color .2s,box-shadow .2s;transition:background-color .2s,box-shadow .2s}.btn .icon,.btn .ngx-icon{font-weight:400;vertical-align:middle;line-height:1em;font-size:.9em}.btn .icon:before,.btn .ngx-icon:before{font-weight:inherit}.btn .icon.has-text,.btn .icon.has-text-right,.btn .ngx-icon.has-text,.btn .ngx-icon.has-text-right{margin-right:.2em}.btn .icon.has-text-left,.btn .ngx-icon.has-text-left{margin-left:.2em}.btn::-moz-focus-inner{border:0;padding:0}.btn:focus{outline:0;box-shadow:0 1px 8px 0 rgba(0,0,0,.2),0 3px 4px 0 rgba(0,0,0,.14),0 3px 3px -2px rgba(0,0,0,.12)}.btn:active:hover:focus:not(.disabled),.btn:active:hover:focus:not([disabled]){cursor:pointer;background:#313847}.btn:active:hover:focus:not(.disabled).btn-primary,.btn:active:hover:focus:not([disabled]).btn-primary{background-color:#1483ff}.btn:active:hover:focus:not(.disabled).btn-warning,.btn:active:hover:focus:not([disabled]).btn-warning{background-color:#ffa814}.btn:active:hover:focus:not(.disabled).btn-danger,.btn:active:hover:focus:not([disabled]).btn-danger{background-color:#ff4514}.btn:active:hover:focus:not(.disabled).btn-link,.btn:active:hover:focus:not([disabled]).btn-link{background-color:transparent}.btn:active:hover:focus:not(.disabled).btn-bordered,.btn:active:hover:focus:not([disabled]).btn-bordered{border-color:#94c6ff;color:#94c6ff}.btn:active,.btn:focus,.btn:hover{text-decoration:none}.btn.small{font-size:.6em}.btn.large{font-size:1.3em}.btn.btn-primary{background-color:#479eff}.btn.btn-primary.btn-primary-gradient{background:linear-gradient(125.43deg,#54cdfc 10.86%,#479eff 49.11%)}.btn.btn-warning{background-color:#ffbb47;color:#07080b}.btn.btn-danger{background-color:#ff6d47}.btn.btn-link{background-color:transparent;box-shadow:none}.btn.btn-bordered,.btn.btn-primary.btn-bordered{border:1px solid #479eff;color:#479eff;background-color:transparent;box-shadow:none}.btn.btn-bordered.disabled-button,.btn.btn-primary.btn-bordered.disabled-button{opacity:.5}.btn.btn-bordered.disabled-button .button,.btn.btn-primary.btn-bordered.disabled-button .button{opacity:1}.btn.btn-default.btn-bordered{border:1px solid #fff;color:#fff;background-color:transparent;box-shadow:none}.btn.btn-default.btn-bordered:hover{border-color:#1483ff!important;color:#1483ff!important}.btn.btn-default.btn-bordered.disabled-button{opacity:.5}.btn.btn-default.btn-bordered.disabled-button .button{opacity:1}.btn.btn-file{cursor:pointer;padding:0}.btn.btn-file label{display:block;cursor:pointer;padding:.35em .75em}.btn.btn-file[disabled] label{cursor:not-allowed}.btn.btn-file input[type=file]{pointer-events:none;position:absolute;left:-9999px}.ngx-file-button{display:inline-block;box-sizing:border-box;position:relative}.ngx-file-button .ngx-file-button-input{position:absolute;left:-9999px}.ngx-file-button .ngx-file-button-label{cursor:pointer}.ngx-file-button.standard-style .icon-check{display:none}.ngx-file-button.standard-style .ngx-file-button-text{font-size:.9rem;margin-left:8px;color:#696969}.ngx-file-button.progress-style{min-width:150px;text-align:center;-webkit-transition:.3s .3s;transition:.3s .3s;max-height:50px;overflow:hidden}.ngx-file-button.progress-style .ngx-file-button-button{width:100%;background:#455066;border:none;border-radius:50px;padding:5px 0;-webkit-transition:.3s;transition:.3s;position:relative;margin:0}.ngx-file-button.progress-style .ngx-file-button-button:focus:not(.disabled),.ngx-file-button.progress-style .ngx-file-button-button:focus:not([disabled]),.ngx-file-button.progress-style .ngx-file-button-button:hover:not(.disabled),.ngx-file-button.progress-style .ngx-file-button-button:hover:not([disabled]){background:#313847}.ngx-file-button.progress-style .ngx-file-button-button .ngx-file-button-label{color:#cfcfcf;font-size:18px;font-weight:400;line-height:40px;max-height:40px;-webkit-transition:.3s;transition:.3s;cursor:pointer;display:block}.ngx-file-button.progress-style .ngx-file-button-button.disabled .ngx-file-button-label,.ngx-file-button.progress-style .ngx-file-button-button[disabled] .ngx-file-button-label{cursor:not-allowed}.ngx-file-button.progress-style .ngx-file-button-button .ngx-file-button-text{display:none}.ngx-file-button.progress-style .ngx-file-button-fill{position:absolute;top:0;left:0;bottom:0;right:0;width:0%;background:#479eff;border-radius:50px;display:none}.ngx-file-button.progress-style .icon-check{font-size:25px;color:#cfcfcf;position:absolute;top:0;left:0;right:0;bottom:0;line-height:50px;-webkit-transform:scale(0);transform:scale(0)}.ngx-file-button.progress-style.active{padding:0}.ngx-file-button.progress-style.active .ngx-file-button-button{background:#696969;margin-top:25px}.ngx-file-button.progress-style.active .ngx-file-button-fill{display:block;margin-top:25px;-webkit-transition:.1s .1s;transition:.1s .1s}.ngx-file-button.progress-style.active .ngx-file-button-label{display:none}.ngx-file-button.progress-style.success .ngx-file-button-button{margin:0;padding:25px;width:50px;background:#479eff}.ngx-file-button.progress-style.success .ngx-file-button-fill,.ngx-file-button.progress-style.success .ngx-file-button-label{display:none}.ngx-file-button.progress-style.success .icon-check{-webkit-transform:scale(1);transform:scale(1);-webkit-transition:.3s .3s;transition:.3s .3s}"]
        }),
        __metadata("design:paramtypes", [NgZone])
    ], FileButtonComponent);
    return FileButtonComponent;
}());
export { FileButtonComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsZS1idXR0b24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHN3aW1sYW5lL25neC11aS8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2J1dHRvbi9maWxlLWJ1dHRvbi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsS0FBSyxFQUNMLE1BQU0sRUFDTixZQUFZLEVBQ1osTUFBTSxFQUNOLGlCQUFpQixFQUNqQixNQUFNLEVBQ04sWUFBWSxFQUNaLFdBQVcsRUFDWCxTQUFTLEVBQ1QsVUFBVSxFQUNWLHVCQUF1QixFQUN4QixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUM5RCxPQUFPLEVBQXVCLFlBQVksRUFBWSxNQUFNLDJCQUEyQixDQUFDO0FBRXhGLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRS9ELElBQUksTUFBTSxHQUFHLENBQUMsQ0FBQztBQVVmO0lBMkRFLDZCQUE2QixPQUFlO1FBQWYsWUFBTyxHQUFQLE9BQU8sQ0FBUTtRQTFEbkMsT0FBRSxHQUFXLFdBQVMsRUFBRSxNQUFRLENBQUM7UUFFakMsY0FBUyxHQUFHLG1CQUFtQixDQUFDLFFBQVEsQ0FBQztRQW9CeEMsb0JBQWUsR0FBRyxJQUFJLFlBQVksRUFBMEIsQ0FBQztRQUM3RCxxQkFBZ0IsR0FBRyxJQUFJLFlBQVksRUFBMEIsQ0FBQztRQUM5RCxnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFpRSxDQUFDO1FBQ2hHLGNBQVMsR0FBRyxJQUFJLFlBQVksRUFBc0QsQ0FBQztRQUNuRixnQkFBVyxHQUFHLElBQUksWUFBWSxFQUF3QixDQUFDO1FBdUJ4RCx3QkFBbUIsR0FBRyxtQkFBbUIsQ0FBQztRQUNuRCxhQUFRLEdBQVcsQ0FBQyxDQUFDO1FBQ3JCLGFBQVEsR0FBVyxFQUFFLENBQUM7UUFDdEIscUJBQWdC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QixDQUFDLElBQUk7WUFDckMsZUFBZSxFQUFFLHVCQUF1QixDQUFDLE1BQU07O1NBQ2hELENBQUM7eUNBNERzQyxNQUFNO09BM0RqQyxtQkFBbUIsQ0ErSC9CO0lBQUQsMEJBQUM7Q0FBQSxBQS9IRCxJQStIQztTQS9IWSxtQkFBbUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21wb25lbnQsXG4gIElucHV0LFxuICBPdXRwdXQsXG4gIEV2ZW50RW1pdHRlcixcbiAgTmdab25lLFxuICBWaWV3RW5jYXBzdWxhdGlvbixcbiAgT25Jbml0LFxuICBDb250ZW50Q2hpbGQsXG4gIFRlbXBsYXRlUmVmLFxuICBWaWV3Q2hpbGQsXG4gIEVsZW1lbnRSZWYsXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5XG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgY29lcmNlQm9vbGVhblByb3BlcnR5IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2NvZXJjaW9uJztcbmltcG9ydCB7IEZpbGVVcGxvYWRlck9wdGlvbnMsIEZpbGVVcGxvYWRlciwgRmlsZUl0ZW0gfSBmcm9tICdAc3dpbWxhbmUvbmcyLWZpbGUtdXBsb2FkJztcblxuaW1wb3J0IHsgRmlsZUJ1dHRvblN0eWxlVHlwZSB9IGZyb20gJy4vZmlsZS1idXR0b24tc3R5bGUudHlwZSc7XG5cbmxldCBuZXh0SWQgPSAwO1xuXG5AQ29tcG9uZW50KHtcbiAgZXhwb3J0QXM6ICduZ3hGaWxlQnV0dG9uJyxcbiAgc2VsZWN0b3I6ICduZ3gtZmlsZS1idXR0b24nLFxuICB0ZW1wbGF0ZVVybDogJy4vZmlsZS1idXR0b24uY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9maWxlLWJ1dHRvbi5jb21wb25lbnQuc2NzcyddLFxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxufSlcbmV4cG9ydCBjbGFzcyBGaWxlQnV0dG9uQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQElucHV0KCkgaWQ6IHN0cmluZyA9IGBpbnB1dC0keysrbmV4dElkfWA7XG4gIEBJbnB1dCgpIG5hbWU6IHN0cmluZztcbiAgQElucHV0KCkgc3R5bGVUeXBlID0gRmlsZUJ1dHRvblN0eWxlVHlwZS5zdGFuZGFyZDtcbiAgQElucHV0KCkgdXBsb2FkZXI6IEZpbGVVcGxvYWRlcjtcbiAgQElucHV0KCkgb3B0aW9uczogRmlsZVVwbG9hZGVyT3B0aW9ucztcblxuICBASW5wdXQoKVxuICBnZXQgZGlzYWJsZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2Rpc2FibGVkO1xuICB9XG4gIHNldCBkaXNhYmxlZChkaXNhYmxlZCkge1xuICAgIHRoaXMuX2Rpc2FibGVkID0gY29lcmNlQm9vbGVhblByb3BlcnR5KGRpc2FibGVkKTtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIGdldCBtdWx0aXBsZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fbXVsdGlwbGU7XG4gIH1cbiAgc2V0IG11bHRpcGxlKG11bHRpcGxlKSB7XG4gICAgdGhpcy5fbXVsdGlwbGUgPSBjb2VyY2VCb29sZWFuUHJvcGVydHkobXVsdGlwbGUpO1xuICB9XG5cbiAgQE91dHB1dCgpIGFmdGVyQWRkaW5nRmlsZSA9IG5ldyBFdmVudEVtaXR0ZXI8eyBmaWxlSXRlbTogRmlsZUl0ZW0gfT4oKTtcbiAgQE91dHB1dCgpIGJlZm9yZVVwbG9hZEl0ZW0gPSBuZXcgRXZlbnRFbWl0dGVyPHsgZmlsZUl0ZW06IEZpbGVJdGVtIH0+KCk7XG4gIEBPdXRwdXQoKSBzdWNjZXNzSXRlbSA9IG5ldyBFdmVudEVtaXR0ZXI8eyBpdGVtOiBhbnk7IHJlc3BvbnNlOiBzdHJpbmc7IHN0YXR1czogbnVtYmVyOyBoZWFkZXJzOiBhbnkgfT4oKTtcbiAgQE91dHB1dCgpIGVycm9ySXRlbSA9IG5ldyBFdmVudEVtaXR0ZXI8eyByZXNwb25zZTogc3RyaW5nOyBzdGF0dXM6IG51bWJlcjsgaGVhZGVyczogYW55IH0+KCk7XG4gIEBPdXRwdXQoKSBwcm9ncmVzc0FsbCA9IG5ldyBFdmVudEVtaXR0ZXI8eyBwcm9ncmVzczogbnVtYmVyIH0+KCk7XG5cbiAgQENvbnRlbnRDaGlsZCgnZHJvcHpvbmVUZW1wbGF0ZScpXG4gIHJlYWRvbmx5IGRyb3B6b25lVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgQFZpZXdDaGlsZCgnZmlsZUlucHV0JylcbiAgcmVhZG9ubHkgZmlsZUlucHV0PzogRWxlbWVudFJlZjxIVE1MSW5wdXRFbGVtZW50PjtcblxuICBnZXQgaXNEaXNhYmxlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5kaXNhYmxlZCB8fCB0aGlzLnVwbG9hZGVyLmlzVXBsb2FkaW5nO1xuICB9XG5cbiAgZ2V0IGNzc0NsYXNzZXMoKTogYW55IHtcbiAgICByZXR1cm4ge1xuICAgICAgJ25neC1maWxlLWJ1dHRvbic6IHRydWUsXG4gICAgICAnc3RhbmRhcmQtc3R5bGUnOiB0aGlzLnN0eWxlVHlwZSA9PT0gRmlsZUJ1dHRvblN0eWxlVHlwZS5zdGFuZGFyZCxcbiAgICAgICdwcm9ncmVzcy1zdHlsZSc6IHRoaXMuc3R5bGVUeXBlID09PSBGaWxlQnV0dG9uU3R5bGVUeXBlLnByb2dyZXNzLFxuICAgICAgJ3Nob3ctcHJvZ3Jlc3MnOiB0aGlzLnVwbG9hZGVyICYmIHRoaXMudXBsb2FkZXIub3B0aW9ucy5pc0hUTUw1LFxuICAgICAgc3VjY2VzczogdGhpcy5faXNJdGVtU3VjY2Vzc2Z1bCxcbiAgICAgIGFjdGl2ZTogdGhpcy51cGxvYWRlciAmJiB0aGlzLnVwbG9hZGVyLmlzVXBsb2FkaW5nXG4gICAgfTtcbiAgfVxuXG4gIHJlYWRvbmx5IEZpbGVCdXR0b25TdHlsZVR5cGUgPSBGaWxlQnV0dG9uU3R5bGVUeXBlO1xuICBwcm9ncmVzczogbnVtYmVyID0gMDtcbiAgZmlsZU5hbWU6IHN0cmluZyA9ICcnO1xuICBmaWxlT3ZlckRyb3B6b25lOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBfaXNJdGVtU3VjY2Vzc2Z1bDogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIF9kaXNhYmxlZDogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIF9tdWx0aXBsZTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgX25nWm9uZTogTmdab25lKSB7fVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuX25nWm9uZS5ydW4oKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLnVwbG9hZGVyICYmICF0aGlzLm9wdGlvbnMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbXVzdCBwYXNzIGVpdGhlciBhbiB1cGxvYWRlciBpbnN0YW5jZSBvciBvcHRpb25zLicpO1xuICAgICAgfVxuXG4gICAgICAvLyBpZiBvcHRpb25zIHdlcmUgcGFzc2VkLCBpbml0IGEgbmV3IHVwbG9hZGVyXG4gICAgICBpZiAoIXRoaXMudXBsb2FkZXIgJiYgdGhpcy5vcHRpb25zKSB7XG4gICAgICAgIHRoaXMudXBsb2FkZXIgPSBuZXcgRmlsZVVwbG9hZGVyKHRoaXMub3B0aW9ucyk7XG4gICAgICB9XG5cbiAgICAgIC8vIGFsd2F5cyByZW1vdmUgYWZ0ZXIgdXBsb2FkIGZvciB0aGlzIGNhc2VcbiAgICAgIHRoaXMudXBsb2FkZXIub3B0aW9ucy5yZW1vdmVBZnRlclVwbG9hZCA9IHRydWU7XG5cbiAgICAgIHRoaXMudXBsb2FkZXIub25BZnRlckFkZGluZ0ZpbGUgPSB0aGlzLm9uQWZ0ZXJBZGRpbmdGaWxlLmJpbmQodGhpcyk7XG4gICAgICB0aGlzLnVwbG9hZGVyLm9uQmVmb3JlVXBsb2FkSXRlbSA9IHRoaXMub25CZWZvcmVVcGxvYWRJdGVtLmJpbmQodGhpcyk7XG4gICAgICB0aGlzLnVwbG9hZGVyLm9uUHJvZ3Jlc3NBbGwgPSB0aGlzLm9uUHJvZ3Jlc3NBbGwuYmluZCh0aGlzKTtcbiAgICAgIHRoaXMudXBsb2FkZXIub25TdWNjZXNzSXRlbSA9IHRoaXMub25TdWNjZXNzSXRlbS5iaW5kKHRoaXMpO1xuICAgICAgdGhpcy51cGxvYWRlci5vbkVycm9ySXRlbSA9IHRoaXMub25FcnJvckl0ZW0uYmluZCh0aGlzKTtcbiAgICB9KTtcbiAgfVxuXG4gIG9uQWZ0ZXJBZGRpbmdGaWxlKGZpbGVJdGVtOiBGaWxlSXRlbSk6IHZvaWQge1xuICAgIHRoaXMuX25nWm9uZS5ydW4oKCkgPT4ge1xuICAgICAgdGhpcy5maWxlTmFtZSA9IGZpbGVJdGVtLmZpbGUubmFtZTtcbiAgICAgIHRoaXMuYWZ0ZXJBZGRpbmdGaWxlLmVtaXQoeyBmaWxlSXRlbSB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIG9uQmVmb3JlVXBsb2FkSXRlbShmaWxlSXRlbTogRmlsZUl0ZW0pIHtcbiAgICB0aGlzLl9uZ1pvbmUucnVuKCgpID0+IHtcbiAgICAgIHRoaXMuYmVmb3JlVXBsb2FkSXRlbS5lbWl0KHsgZmlsZUl0ZW0gfSk7XG4gICAgfSk7XG4gIH1cblxuICBvbkVycm9ySXRlbShyZXNwb25zZTogc3RyaW5nLCBzdGF0dXM6IG51bWJlciwgaGVhZGVyczogYW55KTogdm9pZCB7XG4gICAgdGhpcy5lcnJvckl0ZW0uZW1pdCh7IHJlc3BvbnNlLCBzdGF0dXMsIGhlYWRlcnMgfSk7XG4gIH1cblxuICBvblByb2dyZXNzQWxsKHByb2dyZXNzOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLl9uZ1pvbmUucnVuKCgpID0+IHtcbiAgICAgIHRoaXMucHJvZ3Jlc3MgPSBwcm9ncmVzcztcbiAgICAgIHRoaXMucHJvZ3Jlc3NBbGwuZW1pdCh7IHByb2dyZXNzIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgb25TdWNjZXNzSXRlbShpdGVtOiBhbnksIHJlc3BvbnNlOiBzdHJpbmcsIHN0YXR1czogbnVtYmVyLCBoZWFkZXJzOiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLl9uZ1pvbmUucnVuKCgpID0+IHtcbiAgICAgIHRoaXMuX2lzSXRlbVN1Y2Nlc3NmdWwgPSB0cnVlO1xuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5maWxlTmFtZSA9ICcnO1xuICAgICAgICB0aGlzLl9pc0l0ZW1TdWNjZXNzZnVsID0gZmFsc2U7XG4gICAgICB9LCAyNTAwKTtcblxuICAgICAgdGhpcy5zdWNjZXNzSXRlbS5lbWl0KHsgaXRlbSwgcmVzcG9uc2UsIHN0YXR1cywgaGVhZGVycyB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZpbGVPdmVyQmFzZShldmVudDogYm9vbGVhbikge1xuICAgIHRoaXMuZmlsZU92ZXJEcm9wem9uZSA9IGV2ZW50O1xuICB9XG5cbiAgY2xlYXJJbnB1dCgpIHtcbiAgICB0aGlzLmZpbGVJbnB1dC5uYXRpdmVFbGVtZW50LnZhbHVlID0gJyc7XG4gIH1cbn1cbiJdfQ==